{
  "$id": "https://mapcolonies.com/three_d/storeTrigger/v1",
  "description": "The store-trigger schema",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["jobManager", "storage"],
  "allOf": [
    {
      "$ref": "https://mapcolonies.com/common/boilerplate/v4"
    },
    {
      "type": "object",
      "properties": {
        "jobManager": {
          "type": "object",
          "allOf": [
            {
              "$ref": "https://mapcolonies.com/infra/jobManager/forClients/v1"
            },
            {
              "properties": {
                "extraConfigs": {
                  "type": "object",
                  "default": {},
                  "properties": {
                    "taskBatches": {
                      "type": "number",
                      "description": "How many paths a task can contain",
                      "default": 1000,
                      "x-env-value": "TASK_BATCHES"
                    }
                  }
                }
              }
            }
          ],
          "required": ["task", "job", "url"]
        }
      }
    },
    {
      "type": "object",
      "properties": {
        "storage": {
          "$ref": "https://mapcolonies.com/three_d/common/provider/v1"
        }
      }
    },
    {
      "type": "object",
      "properties": {
        "maxConcurrency": {
          "type": "number",
          "description": "How many tasks can be send to job manager at once",
          "default": 5
        },
        "blackList": {
          "type": "array",
          "description": "The black list of file formats that should be ignored",
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "default": ["tar", "zip", "rar", "7z"]
        }
      }
    }
  ]
}
