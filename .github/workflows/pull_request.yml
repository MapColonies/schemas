name: pull_request

on: [pull_request, workflow_dispatch]

jobs:
  validate_schemas:
    name: validate schemas 
    runs-on: ubuntu-latest

    steps:
      - name: Check out TS Project Git repository
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20.x
          cache: npm

      - name: Install TS Project dependencies
        run: npm ci

      - name: Run the validations
        run: npm run validate

  check_for_changed_files:
    name: check for changed schemas
    runs-on: ubuntu-latest

    steps:
      - name: Check out TS Project Git repository
        uses: actions/checkout@v4
        with:
          fetch-tags: true
          fetch-depth: '0'

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20.x
          cache: npm

      - name: Install TS Project dependencies
        run: npm ci

      - name: Run the validations
        run: npm run check-files-changed
