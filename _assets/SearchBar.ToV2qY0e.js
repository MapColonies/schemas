import{c as Tt,j}from"./createLucideIcon.BkdUjrrN.js";import{r as T}from"./index.Cd_vQiNd.js";import{c as ye,B as ve,n as Vt}from"./button.BVyyTnM8.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],be=Tt("chevron-right",ke);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],_t=Tt("search",je);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Se=Tt("x",Ce),Et=T.createContext({open:!1,onOpenChange:()=>{}});function Me({open:t=!1,onOpenChange:i,children:e}){const[s,n]=T.useState(t),r=i!==void 0,o=r?t:s,h=l=>{r?i?.(l):n(l)};return T.useEffect(()=>{r||n(t)},[t,r]),j.jsx(Et.Provider,{value:{open:o,onOpenChange:h},children:e})}function Ne({children:t,asChild:i}){const{onOpenChange:e}=T.useContext(Et);return i&&T.isValidElement(t)?T.cloneElement(t,{onClick:s=>{s.preventDefault(),e(!0),t.props.onClick?.(s)}}):j.jsx("div",{onClick:()=>e(!0),children:t})}function _e({children:t,className:i}){const{open:e,onOpenChange:s}=T.useContext(Et);return T.useEffect(()=>{const n=r=>{r.key==="Escape"&&s(!1)};return e&&(document.addEventListener("keydown",n),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",n),document.body.style.overflow=""}},[e,s]),e?j.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[10vh]",children:[j.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>s(!1)}),j.jsxs("div",{className:ye("relative z-50 w-full max-w-2xl bg-background border rounded-lg shadow-lg","animate-in fade-in-0 zoom-in-95 duration-200",i),children:[j.jsxs("button",{onClick:()=>s(!1),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[j.jsx(Se,{className:"h-4 w-4"}),j.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}):null}const $e="modulepreload",ze=function(t){return"/schemas/"+t},Qt={},Be=function(i,e,s){let n=Promise.resolve();if(e&&e.length>0){let o=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then(a=>({status:"fulfilled",value:a}),a=>({status:"rejected",reason:a}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),l=h?.nonce||h?.getAttribute("nonce");n=o(e.map(f=>{if(f=ze(f),f in Qt)return;Qt[f]=!0;const u=f.endsWith(".css"),a=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${a}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":$e,u||(p.as="script"),p.crossOrigin="",p.href=f,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((c,m)=>{p.addEventListener("load",c),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(o){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o}return n.then(o=>{for(const h of o||[])h.status==="rejected"&&r(h.reason);return i().catch(r)})};var x;function I(t,i,e){const s=typeof e,n=typeof t;if(s!=="undefined"){if(n!=="undefined"){if(e){if(n==="function"&&s===n)return function(h){return t(e(h))};if(i=t.constructor,i===e.constructor){if(i===Array)return e.concat(t);if(i===Map){var r=new Map(e);for(var o of t)r.set(o[0],o[1]);return r}if(i===Set){o=new Set(e);for(r of t.values())o.add(r);return o}}}return t}return e}return n==="undefined"?i:t}function et(t,i){return typeof t>"u"?i:t}function A(){return Object.create(null)}function K(t){return typeof t=="string"}function ut(t){return typeof t=="object"}function ct(t,i){if(K(i))t=t[i];else for(let e=0;t&&e<i.length;e++)t=t[i[e]];return t}const Oe=/[^\p{L}\p{N}]+/u,Ae=/(\d{3})/g,Le=/(\D)(\d{3})/g,Pe=/(\d{3})(\D)/g,Xt=/[\u0300-\u036f]/g;function at(t={}){if(!this||this.constructor!==at)return new at(...arguments);if(arguments.length)for(t=0;t<arguments.length;t++)this.assign(arguments[t]);else this.assign(t)}x=at.prototype;x.assign=function(t){this.normalize=I(t.normalize,!0,this.normalize);let i=t.include,e=i||t.exclude||t.split,s;if(e||e===""){if(typeof e=="object"&&e.constructor!==RegExp){let n="";s=!i,i||(n+="\\p{Z}"),e.letter&&(n+="\\p{L}"),e.number&&(n+="\\p{N}",s=!!i),e.symbol&&(n+="\\p{S}"),e.punctuation&&(n+="\\p{P}"),e.control&&(n+="\\p{C}"),(e=e.char)&&(n+=typeof e=="object"?e.join(""):e);try{this.split=new RegExp("["+(i?"^":"")+n+"]+","u")}catch{this.split=/\s+/}}else this.split=e,s=e===!1||"a1a".split(e).length<2;this.numeric=I(t.numeric,s)}else{try{this.split=I(this.split,Oe)}catch{this.split=/\s+/}this.numeric=I(t.numeric,I(this.numeric,!0))}if(this.prepare=I(t.prepare,null,this.prepare),this.finalize=I(t.finalize,null,this.finalize),e=t.filter,this.filter=typeof e=="function"?e:I(e&&new Set(e),null,this.filter),this.dedupe=I(t.dedupe,!0,this.dedupe),this.matcher=I((e=t.matcher)&&new Map(e),null,this.matcher),this.mapper=I((e=t.mapper)&&new Map(e),null,this.mapper),this.stemmer=I((e=t.stemmer)&&new Map(e),null,this.stemmer),this.replacer=I(t.replacer,null,this.replacer),this.minlength=I(t.minlength,1,this.minlength),this.maxlength=I(t.maxlength,1024,this.maxlength),this.rtl=I(t.rtl,!1,this.rtl),(this.cache=e=I(t.cache,!0,this.cache))&&(this.F=null,this.L=typeof e=="number"?e:2e5,this.B=new Map,this.D=new Map,this.I=this.H=128),this.h="",this.J=null,this.A="",this.K=null,this.matcher)for(const n of this.matcher.keys())this.h+=(this.h?"|":"")+n;if(this.stemmer)for(const n of this.stemmer.keys())this.A+=(this.A?"|":"")+n;return this};x.addStemmer=function(t,i){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(t,i),this.A+=(this.A?"|":"")+t,this.K=null,this.cache&&G(this),this};x.addFilter=function(t){return typeof t=="function"?this.filter=t:(this.filter||(this.filter=new Set),this.filter.add(t)),this.cache&&G(this),this};x.addMapper=function(t,i){return typeof t=="object"?this.addReplacer(t,i):t.length>1?this.addMatcher(t,i):(this.mapper||(this.mapper=new Map),this.mapper.set(t,i),this.cache&&G(this),this)};x.addMatcher=function(t,i){return typeof t=="object"?this.addReplacer(t,i):t.length<2&&(this.dedupe||this.mapper)?this.addMapper(t,i):(this.matcher||(this.matcher=new Map),this.matcher.set(t,i),this.h+=(this.h?"|":"")+t,this.J=null,this.cache&&G(this),this)};x.addReplacer=function(t,i){return typeof t=="string"?this.addMatcher(t,i):(this.replacer||(this.replacer=[]),this.replacer.push(t,i),this.cache&&G(this),this)};x.encode=function(t,i){if(this.cache&&t.length<=this.H)if(this.F){if(this.B.has(t))return this.B.get(t)}else this.F=setTimeout(G,50,this);this.normalize&&(typeof this.normalize=="function"?t=this.normalize(t):t=Xt?t.normalize("NFKD").replace(Xt,"").toLowerCase():t.toLowerCase()),this.prepare&&(t=this.prepare(t)),this.numeric&&t.length>3&&(t=t.replace(Le,"$1 $2").replace(Pe,"$1 $2").replace(Ae,"$1 "));const e=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let s=[],n=A(),r,o,h=this.split||this.split===""?t.split(this.split):[t];for(let f=0,u,a;f<h.length;f++)if((u=a=h[f])&&!(u.length<this.minlength||u.length>this.maxlength)){if(i){if(n[u])continue;n[u]=1}else{if(r===u)continue;r=u}if(e)s.push(u);else if(!this.filter||(typeof this.filter=="function"?this.filter(u):!this.filter.has(u))){if(this.cache&&u.length<=this.I)if(this.F){var l=this.D.get(u);if(l||l===""){l&&s.push(l);continue}}else this.F=setTimeout(G,50,this);if(this.stemmer){this.K||(this.K=new RegExp("(?!^)("+this.A+")$"));let p;for(;p!==u&&u.length>2;)p=u,u=u.replace(this.K,c=>this.stemmer.get(c))}if(u&&(this.mapper||this.dedupe&&u.length>1)){l="";for(let p=0,c="",m,d;p<u.length;p++)m=u.charAt(p),m===c&&this.dedupe||((d=this.mapper&&this.mapper.get(m))||d===""?d===c&&this.dedupe||!(c=d)||(l+=d):l+=c=m);u=l}if(this.matcher&&u.length>1&&(this.J||(this.J=new RegExp("("+this.h+")","g")),u=u.replace(this.J,p=>this.matcher.get(p))),u&&this.replacer)for(l=0;u&&l<this.replacer.length;l+=2)u=u.replace(this.replacer[l],this.replacer[l+1]);if(this.cache&&a.length<=this.I&&(this.D.set(a,u),this.D.size>this.L&&(this.D.clear(),this.I=this.I/1.1|0)),u){if(u!==a)if(i){if(n[u])continue;n[u]=1}else{if(o===u)continue;o=u}s.push(u)}}}return this.finalize&&(s=this.finalize(s)||s),this.cache&&t.length<=this.H&&(this.B.set(t,s),this.B.size>this.L&&(this.B.clear(),this.H=this.H/1.1|0)),s};function G(t){t.F=null,t.B.clear(),t.D.clear()}function Rt(t,i,e){e||(i||typeof t!="object"?typeof i=="object"&&(e=i,i=0):e=t),e&&(t=e.query||t,i=e.limit||i);let s=""+(i||0);e&&(s+=(e.offset||0)+!!e.context+!!e.suggest+(e.resolve!==!1)+(e.resolution||this.resolution)+(e.boost||0)),t=(""+t).toLowerCase(),this.cache||(this.cache=new tt);let n=this.cache.get(t+s);if(!n){const r=e&&e.cache;r&&(e.cache=!1),n=this.search(t,i,e),r&&(e.cache=r),this.cache.set(t+s,n)}return n}function tt(t){this.limit=t&&t!==!0?t:1e3,this.cache=new Map,this.h=""}tt.prototype.set=function(t,i){this.cache.set(this.h=t,i),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)};tt.prototype.get=function(t){const i=this.cache.get(t);return i&&this.h!==t&&(this.cache.delete(t),this.cache.set(this.h=t,i)),i};tt.prototype.remove=function(t){for(const i of this.cache){const e=i[0];i[1].includes(t)&&this.cache.delete(e)}};tt.prototype.clear=function(){this.cache.clear(),this.h=""};const Zt={normalize:!1,numeric:!1,dedupe:!1},mt={},$t=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),Yt=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),Ut=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],Gt={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,ÃŸ:2,d:3,t:3,l:4,m:5,n:5,r:6};var he={Exact:Zt,Default:mt,Normalize:mt,LatinBalance:{mapper:$t},LatinAdvanced:{mapper:$t,matcher:Yt,replacer:Ut},LatinExtra:{mapper:$t,replacer:Ut.concat([/(?!^)[aeo]/g,""]),matcher:Yt},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(t){for(let e=0;e<t.length;e++){var i=t[e];let s=i.charAt(0),n=Gt[s];for(let r=1,o;r<i.length&&(o=i.charAt(r),o==="h"||o==="w"||!(o=Gt[o])||o===n||(s+=o,n=o,s.length!==4));r++);t[e]=s}}},CJK:{split:""},LatinExact:Zt,LatinDefault:mt,LatinSimple:mt};function qt(t,i,e,s){let n=[];for(let r=0,o;r<t.index.length;r++)if(o=t.index[r],i>=o.length)i-=o.length;else{i=o[s?"splice":"slice"](i,e);const h=i.length;if(h&&(n=n.length?n.concat(i):i,e-=h,s&&(t.length-=h),!e))break;i=0}return n}function rt(t){if(!this||this.constructor!==rt)return new rt(t);this.index=t?[t]:[],this.length=t?t.length:0;const i=this;return new Proxy([],{get(e,s){if(s==="length")return i.length;if(s==="push")return function(n){i.index[i.index.length-1].push(n),i.length++};if(s==="pop")return function(){if(i.length)return i.length--,i.index[i.index.length-1].pop()};if(s==="indexOf")return function(n){let r=0;for(let o=0,h,l;o<i.index.length;o++){if(h=i.index[o],l=h.indexOf(n),l>=0)return r+l;r+=h.length}return-1};if(s==="includes")return function(n){for(let r=0;r<i.index.length;r++)if(i.index[r].includes(n))return!0;return!1};if(s==="slice")return function(n,r){return qt(i,n||0,r||i.length,!1)};if(s==="splice")return function(n,r){return qt(i,n||0,r||i.length,!0)};if(s==="constructor")return Array;if(typeof s!="symbol")return(e=i.index[s/2**31|0])&&e[s]},set(e,s,n){return e=s/2**31|0,(i.index[e]||(i.index[e]=[]))[s]=n,i.length++,!0}})}rt.prototype.clear=function(){this.index.length=0};rt.prototype.push=function(){};function H(t=8){if(!this||this.constructor!==H)return new H(t);this.index=A(),this.h=[],this.size=0,t>32?(this.B=fe,this.A=BigInt(t)):(this.B=le,this.A=t)}H.prototype.get=function(t){const i=this.index[this.B(t)];return i&&i.get(t)};H.prototype.set=function(t,i){var e=this.B(t);let s=this.index[e];s?(e=s.size,s.set(t,i),(e-=s.size)&&this.size++):(this.index[e]=s=new Map([[t,i]]),this.h.push(s),this.size++)};function W(t=8){if(!this||this.constructor!==W)return new W(t);this.index=A(),this.h=[],this.size=0,t>32?(this.B=fe,this.A=BigInt(t)):(this.B=le,this.A=t)}W.prototype.add=function(t){var i=this.B(t);let e=this.index[i];e?(i=e.size,e.add(t),(i-=e.size)&&this.size++):(this.index[i]=e=new Set([t]),this.h.push(e),this.size++)};x=H.prototype;x.has=W.prototype.has=function(t){const i=this.index[this.B(t)];return i&&i.has(t)};x.delete=W.prototype.delete=function(t){const i=this.index[this.B(t)];i&&i.delete(t)&&this.size--};x.clear=W.prototype.clear=function(){this.index=A(),this.h=[],this.size=0};x.values=W.prototype.values=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].values())yield i};x.keys=W.prototype.keys=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].keys())yield i};x.entries=W.prototype.entries=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].entries())yield i};function le(t){let i=2**this.A-1;if(typeof t=="number")return t&i;let e=0,s=this.A+1;for(let n=0;n<t.length;n++)e=(e*s^t.charCodeAt(n))&i;return this.A===32?e+2**31:e}function fe(t){let i=BigInt(2)**this.A-BigInt(1);var e=typeof t;if(e==="bigint")return t&i;if(e==="number")return BigInt(t)&i;e=BigInt(0);let s=this.A+BigInt(1);for(let n=0;n<t.length;n++)e=(e*s^BigInt(t.charCodeAt(n)))&i;return e}let it,ft;async function Ie(t){t=t.data;var i=t.task;const e=t.id;let s=t.args;switch(i){case"init":ft=t.options||{},(i=t.factory)?(Function("return "+i)()(self),it=new self.FlexSearch.Index(ft),delete self.FlexSearch):it=new J(ft),postMessage({id:e});break;default:let n;i==="export"&&(s[1]?(s[0]=ft.export,s[2]=0,s[3]=1):s=null),i==="import"?s[0]&&(t=await ft.import.call(it,s[0]),it.import(s[0],t)):((n=s&&it[i].apply(it,s))&&n.then&&(n=await n),n&&n.await&&(n=await n.await),i==="search"&&n.result&&(n=n.result)),postMessage(i==="search"?{id:e,msg:n}:{id:e})}}function Kt(t){nt.call(t,"add"),nt.call(t,"append"),nt.call(t,"search"),nt.call(t,"update"),nt.call(t,"remove"),nt.call(t,"searchCache")}let Ot,te,yt;function Te(){Ot=yt=0}function nt(t){this[t+"Async"]=function(){const i=arguments;var e=i[i.length-1];let s;if(typeof e=="function"&&(s=e,delete i[i.length-1]),Ot?yt||(yt=Date.now()-te>=this.priority*this.priority*3):(Ot=setTimeout(Te,0),te=Date.now()),yt){const r=this;return new Promise(o=>{setTimeout(function(){o(r[t+"Async"].apply(r,i))},0)})}const n=this[t].apply(this,i);return e=n.then?n:new Promise(r=>r(n)),s&&e.then(s),e}}let Q=0;function ot(t={},i){function e(h){function l(f){f=f.data||f;const u=f.id,a=u&&r.h[u];a&&(a(f.msg),delete r.h[u])}if(this.worker=h,this.h=A(),this.worker)return n?this.worker.on("message",l):this.worker.onmessage=l,t.config?new Promise(function(f){Q>1e9&&(Q=0),r.h[++Q]=function(){f(r)},r.worker.postMessage({id:Q,task:"init",factory:s,options:t})}):(this.priority=t.priority||4,this.encoder=i||null,this.worker.postMessage({task:"init",factory:s,options:t}),this)}if(!this||this.constructor!==ot)return new ot(t);let s=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;s&&(s=s.toString());const n=typeof window>"u",r=this,o=Ee(s,n,t.worker);return o.then?o.then(function(h){return e.call(r,h)}):e.call(this,o)}X("add");X("append");X("search");X("update");X("remove");X("clear");X("export");X("import");ot.prototype.searchCache=Rt;Kt(ot.prototype);function X(t){ot.prototype[t]=function(){const i=this,e=[].slice.call(arguments);var s=e[e.length-1];let n;return typeof s=="function"&&(n=s,e.pop()),s=new Promise(function(r){t==="export"&&typeof e[0]=="function"&&(e[0]=null),Q>1e9&&(Q=0),i.h[++Q]=r,i.worker.postMessage({task:t,id:Q,args:e})}),n?(s.then(n),this):s}}function Ee(t,i,e){return i?typeof module<"u"?new(require("worker_threads")).Worker(__dirname+"/worker/node.js"):Be(()=>import("./__vite-browser-external.BIHI7g3E.js"),[]).then(function(s){return new s.Worker(import.meta.dirname+"/node/node.mjs")}):t?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+Ie.toString()],{type:"text/javascript"}))):new window.Worker(typeof e=="string"?e:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js").replace("flexsearch.bundle.module.min.mjs","module/worker/worker.js"),{type:"module"})}q.prototype.add=function(t,i,e){if(ut(t)&&(i=t,t=ct(i,this.key)),i&&(t||t===0)){if(!e&&this.reg.has(t))return this.update(t,i);for(let h=0,l;h<this.field.length;h++){l=this.B[h];var s=this.index.get(this.field[h]);if(typeof l=="function"){var n=l(i);n&&s.add(t,n,e,!0)}else n=l.G,(!n||n(i))&&(l.constructor===String?l=[""+l]:K(l)&&(l=[l]),Lt(i,l,this.D,0,s,t,l[0],e))}if(this.tag)for(s=0;s<this.A.length;s++){var r=this.A[s];n=this.tag.get(this.F[s]);let h=A();if(typeof r=="function"){if(r=r(i),!r)continue}else{var o=r.G;if(o&&!o(i))continue;r.constructor===String&&(r=""+r),r=ct(i,r)}if(n&&r){K(r)&&(r=[r]);for(let l=0,f,u;l<r.length;l++)if(f=r[l],!h[f]&&(h[f]=1,(o=n.get(f))?u=o:n.set(f,u=[]),!e||!u.includes(t))){if(u.length===2**31-1){if(o=new rt(u),this.fastupdate)for(let a of this.reg.values())a.includes(u)&&(a[a.indexOf(u)]=o);n.set(f,u=o)}u.push(t),this.fastupdate&&((o=this.reg.get(t))?o.push(u):this.reg.set(t,[u]))}}}if(this.store&&(!e||!this.store.has(t))){let h;if(this.h){h=A();for(let l=0,f;l<this.h.length;l++){if(f=this.h[l],(e=f.G)&&!e(i))continue;let u;if(typeof f=="function"){if(u=f(i),!u)continue;f=[f.O]}else if(K(f)||f.constructor===String){h[f]=i[f];continue}At(i,h,f,0,f[0],u)}}this.store.set(t,h||i)}this.worker&&(this.fastupdate||this.reg.add(t))}return this};function At(t,i,e,s,n,r){if(t=t[n],s===e.length-1)i[n]=r||t;else if(t)if(t.constructor===Array)for(i=i[n]=Array(t.length),n=0;n<t.length;n++)At(t,i,e,s,n);else i=i[n]||(i[n]=A()),n=e[++s],At(t,i,e,s,n)}function Lt(t,i,e,s,n,r,o,h){if(t=t[o])if(s===i.length-1){if(t.constructor===Array){if(e[s]){for(i=0;i<t.length;i++)n.add(r,t[i],!0,!0);return}t=t.join(" ")}n.add(r,t,h,!0)}else if(t.constructor===Array)for(o=0;o<t.length;o++)Lt(t,i,e,s,n,r,o,h);else o=i[++s],Lt(t,i,e,s,n,r,o,h)}function Ht(t,i,e,s){if(!t.length)return t;if(t.length===1)return t=t[0],t=e||t.length>i?t.slice(e,e+i):t,s?st.call(this,t):t;let n=[];for(let r=0,o,h;r<t.length;r++)if((o=t[r])&&(h=o.length)){if(e){if(e>=h){e-=h;continue}o=o.slice(e,e+i),h=o.length,e=0}if(h>i&&(o=o.slice(0,i),h=i),!n.length&&h>=i)return s?st.call(this,o):o;if(n.push(o),i-=h,!i)break}return n=n.length>1?[].concat.apply([],n):n[0],s?st.call(this,n):n}function St(t,i,e,s){var n=s[0];if(n[0]&&n[0].query)return t[i].apply(t,n);if(!(i!=="and"&&i!=="not"||t.result.length||t.await||n.suggest))return s.length>1&&(n=s[s.length-1]),(s=n.resolve)?t.await||t.result:t;let r=[],o=0,h=0,l,f,u,a,p;for(i=0;i<s.length;i++)if(n=s[i]){var c=void 0;if(n.constructor===z)c=n.await||n.result;else if(n.then||n.constructor===Array)c=n;else{o=n.limit||0,h=n.offset||0,u=n.suggest,f=n.resolve,l=((a=n.highlight||t.highlight)||n.enrich)&&f,c=n.queue;let m=n.async||c,d=n.index,g=n.query;if(d?t.index||(t.index=d):d=t.index,g||n.tag){const y=n.field||n.pluck;if(y&&(!g||t.query&&!a||(t.query=g,t.field=y,t.highlight=a),d=d.index.get(y)),c&&(p||t.await)){p=1;let w;const v=t.C.length,N=new Promise(function(_){w=_});(function(_,M){N.h=function(){M.index=null,M.resolve=!1;let C=m?_.searchAsync(M):_.search(M);return C.then?C.then(function(k){return t.C[v]=k=k.result||k,w(k),k}):(C=C.result||C,w(C),C)}})(d,Object.assign({},n)),t.C.push(N),r[i]=N;continue}else n.resolve=!1,n.index=null,c=m?d.searchAsync(n):d.search(n),n.resolve=f,n.index=d}else if(n.and)c=wt(n,"and",d);else if(n.or)c=wt(n,"or",d);else if(n.not)c=wt(n,"not",d);else if(n.xor)c=wt(n,"xor",d);else continue}c.await?(p=1,c=c.await):c.then?(p=1,c=c.then(function(m){return m.result||m})):c=c.result||c,r[i]=c}if(p&&!t.await&&(t.await=new Promise(function(m){t.return=m})),p){const m=Promise.all(r).then(function(d){for(let g=0;g<t.C.length;g++)if(t.C[g]===m){t.C[g]=function(){return e.call(t,d,o,h,l,f,u,a)};break}Wt(t)});t.C.push(m)}else if(t.await)t.C.push(function(){return e.call(t,r,o,h,l,f,u,a)});else return e.call(t,r,o,h,l,f,u,a);return f?t.await||t.result:t}function wt(t,i,e){t=t[i];const s=t[0]||t;return s.index||(s.index=e),e=new z(s),t.length>1&&(e=e[i].apply(e,t.slice(1))),e}z.prototype.or=function(){return St(this,"or",Re,arguments)};function Re(t,i,e,s,n,r,o){return t.length&&(this.result.length&&t.push(this.result),t.length<2?this.result=t[0]:(this.result=ue(t,i,e,!1,this.h),e=0)),n&&(this.await=null),n?this.resolve(i,e,s,o):this}z.prototype.and=function(){return St(this,"and",Ke,arguments)};function Ke(t,i,e,s,n,r,o){if(!r&&!this.result.length)return n?this.result:this;let h;if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{let l=0;for(let f=0,u,a;f<t.length;f++)if((u=t[f])&&(a=u.length))l<a&&(l=a);else if(!r){l=0;break}l?(this.result=kt(t,l,i,e,r,this.h,n),h=!0):this.result=[]}else r||(this.result=t);return n&&(this.await=null),n?this.resolve(i,e,s,o,h):this}z.prototype.xor=function(){return St(this,"xor",He,arguments)};function He(t,i,e,s,n,r,o){if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{t:{r=e;var h=this.h;const l=[],f=A();let u=0;for(let a=0,p;a<t.length;a++)if(p=t[a]){u<p.length&&(u=p.length);for(let c=0,m;c<p.length;c++)if(m=p[c])for(let d=0,g;d<m.length;d++)g=m[d],f[g]=f[g]?2:1}for(let a=0,p,c=0;a<u;a++)for(let m=0,d;m<t.length;m++)if((d=t[m])&&(p=d[a])){for(let g=0,y;g<p.length;g++)if(y=p[g],f[y]===1)if(r)r--;else if(n){if(l.push(y),l.length===i){t=l;break t}}else{const w=a+(m?h:0);if(l[w]||(l[w]=[]),l[w].push(y),++c===i){t=l;break t}}}t=l}this.result=t,h=!0}else r||(this.result=t);return n&&(this.await=null),n?this.resolve(i,e,s,o,h):this}z.prototype.not=function(){return St(this,"not",We,arguments)};function We(t,i,e,s,n,r,o){if(!r&&!this.result.length)return n?this.result:this;if(t.length&&this.result.length){t:{r=e;var h=[];t=new Set(t.flat().flat());for(let l=0,f,u=0;l<this.result.length;l++)if(f=this.result[l]){for(let a=0,p;a<f.length;a++)if(p=f[a],!t.has(p)){if(r)r--;else if(n){if(h.push(p),h.length===i){t=h;break t}}else if(h[l]||(h[l]=[]),h[l].push(p),++u===i){t=h;break t}}}t=h}this.result=t,h=!0}return n&&(this.await=null),n?this.resolve(i,e,s,o,h):this}function vt(t,i,e,s,n){let r,o,h;typeof n=="string"?(r=n,n=""):r=n.template,o=r.indexOf("$1"),h=r.substring(o+2),o=r.substring(0,o);let l=n&&n.boundary,f=!n||n.clip!==!1,u=n&&n.merge&&h&&o&&new RegExp(h+" "+o,"g");n=n&&n.ellipsis;var a=0;if(typeof n=="object"){var p=n.template;a=p.length-2,n=n.pattern}typeof n!="string"&&(n=n===!1?"":"..."),a&&(n=p.replace("$1",n)),p=n.length-a;let c,m;typeof l=="object"&&(c=l.before,c===0&&(c=-1),m=l.after,m===0&&(m=-1),l=l.total||9e5),a=new Map;for(let Mt=0,Y,Ft,ht;Mt<i.length;Mt++){let lt;if(s)lt=i,ht=s;else{var d=i[Mt];if(ht=d.field,!ht)continue;lt=d.result}Ft=e.get(ht),Y=Ft.encoder,d=a.get(Y),typeof d!="string"&&(d=Y.encode(t),a.set(Y,d));for(let pt=0;pt<lt.length;pt++){var g=lt[pt].doc;if(!g||(g=ct(g,ht),!g))continue;var y=g.trim().split(/\s+/);if(!y.length)continue;g="";var w=[];let gt=[];for(var v=-1,N=-1,_=0,M=0;M<y.length;M++){var C=y[M],k=Y.encode(C);k=k.length>1?k.join(" "):k[0];let b;if(k&&C){for(var S=C.length,B=(Y.split?C.replace(Y.split,""):C).length-k.length,$="",P=0,E=0;E<d.length;E++){var R=d[E];if(R){var L=R.length;L+=B<0?0:B,P&&L<=P||(R=k.indexOf(R),R>-1&&($=(R?C.substring(0,R):"")+o+C.substring(R,R+L)+h+(R+L<S?C.substring(R+L):""),P=L,b=!0))}}$&&(l&&(v<0&&(v=g.length+(g?1:0)),N=g.length+(g?1:0)+$.length,_+=S,gt.push(w.length),w.push({match:$})),g+=(g?" ":"")+$)}if(!b)C=y[M],g+=(g?" ":"")+C,l&&w.push({text:C});else if(l&&_>=l)break}if(_=gt.length*(r.length-2),c||m||l&&g.length-_>l)if(_=l+_-p*2,M=N-v,c>0&&(M+=c),m>0&&(M+=m),M<=_)y=c?v-(c>0?c:0):v-((_-M)/2|0),w=m?N+(m>0?m:0):y+_,f||(y>0&&g.charAt(y)!==" "&&g.charAt(y-1)!==" "&&(y=g.indexOf(" ",y),y<0&&(y=0)),w<g.length&&g.charAt(w-1)!==" "&&g.charAt(w)!==" "&&(w=g.lastIndexOf(" ",w),w<N?w=N:++w)),g=(y?n:"")+g.substring(y,w)+(w<g.length?n:"");else{for(N=[],v={},_={},M={},C={},k={},$=B=S=0,E=P=1;;){var D=void 0;for(let b=0,O;b<gt.length;b++){if(O=gt[b],$)if(B!==$){if(M[b+1])continue;if(O+=$,v[O]){S-=p,_[b+1]=1,M[b+1]=1;continue}if(O>=w.length-1){if(O>=w.length){M[b+1]=1,O>=y.length&&(_[b+1]=1);continue}S-=p}if(g=w[O].text,L=m&&k[b])if(L>0){if(g.length>L)if(M[b+1]=1,f)g=g.substring(0,L);else continue;(L-=g.length)||(L=-1),k[b]=L}else{M[b+1]=1;continue}if(S+g.length+1<=l)g=" "+g,N[b]+=g;else if(f)D=l-S-1,D>0&&(g=" "+g.substring(0,D),N[b]+=g),M[b+1]=1;else{M[b+1]=1;continue}}else{if(M[b])continue;if(O-=B,v[O]){S-=p,M[b]=1,_[b]=1;continue}if(O<=0){if(O<0){M[b]=1,_[b]=1;continue}S-=p}if(g=w[O].text,L=c&&C[b])if(L>0){if(g.length>L)if(M[b]=1,f)g=g.substring(g.length-L);else continue;(L-=g.length)||(L=-1),C[b]=L}else{M[b]=1;continue}if(S+g.length+1<=l)g+=" ",N[b]=g+N[b];else if(f)D=g.length+1-(l-S),D>=0&&D<g.length&&(g=g.substring(D)+" ",N[b]=g+N[b]),M[b]=1;else{M[b]=1;continue}}else{g=w[O].match,c&&(C[b]=c),m&&(k[b]=m),b&&S++;let Nt;if(O?!b&&p&&(S+=p):(_[b]=1,M[b]=1),O>=y.length-1||O<w.length-1&&w[O+1].match?Nt=1:p&&(S+=p),S-=r.length-2,!b||S+g.length<=l)N[b]=g;else{D=P=E=_[b]=0;break}Nt&&(_[b+1]=1,M[b+1]=1)}S+=g.length,D=v[O]=1}if(D)B===$?$++:B++;else{if(B===$?P=0:E=0,!P&&!E)break;P?(B++,$=B):$++}}g="";for(let b=0,O;b<N.length;b++)O=(_[b]?b?" ":"":(b&&!n?" ":"")+n)+N[b],g+=O;n&&!_[N.length]&&(g+=n)}u&&(g=g.replace(u," ")),lt[pt].highlight=g}if(s)break}return i}function z(t,i){if(!this||this.constructor!==z)return new z(t,i);let e=0,s,n,r,o,h,l;if(t&&t.index){const f=t;if(i=f.index,e=f.boost||0,n=f.query){r=f.field||f.pluck,o=f.highlight;const u=f.resolve;t=f.async||f.queue,f.resolve=!1,f.index=null,t=t?i.searchAsync(f):i.search(f),f.resolve=u,f.index=i,t=t.result||t}else t=[]}if(t&&t.then){const f=this;t=t.then(function(u){f.C[0]=f.result=u.result||u,Wt(f)}),s=[t],t=[],h=new Promise(function(u){l=u})}this.index=i||null,this.result=t||[],this.h=e,this.C=s||[],this.await=h||null,this.return=l||null,this.highlight=o||null,this.query=n||"",this.field=r||""}x=z.prototype;x.limit=function(t){if(this.await){const i=this;this.C.push(function(){return i.limit(t).result})}else if(this.result.length){const i=[];for(let e=0,s;e<this.result.length;e++)if(s=this.result[e])if(s.length<=t){if(i[e]=s,t-=s.length,!t)break}else{i[e]=s.slice(0,t);break}this.result=i}return this};x.offset=function(t){if(this.await){const i=this;this.C.push(function(){return i.offset(t).result})}else if(this.result.length){const i=[];for(let e=0,s;e<this.result.length;e++)(s=this.result[e])&&(s.length<=t?t-=s.length:(i[e]=s.slice(t),t=0));this.result=i}return this};x.boost=function(t){if(this.await){const i=this;this.C.push(function(){return i.boost(t).result})}else this.h+=t;return this};function Wt(t,i){let e=t.result;var s=t.await;t.await=null;for(let n=0,r;n<t.C.length;n++)if(r=t.C[n]){if(typeof r=="function")e=r(),t.C[n]=e=e.result||e,n--;else if(r.h)e=r.h(),t.C[n]=e=e.result||e,n--;else if(r.then)return t.await=s}return s=t.return,t.C=[],t.return=null,i||s(e),e}x.resolve=function(t,i,e,s,n){let r=this.await?Wt(this,!0):this.result;if(r.then){const o=this;return r.then(function(){return o.resolve(t,i,e,s,n)})}return r.length&&(typeof t=="object"?(s=t.highlight||this.highlight,e=!!s||t.enrich,i=t.offset,t=t.limit):(s=s||this.highlight,e=!!s||e),r=n?e?st.call(this.index,r):r:Ht.call(this.index,r,t||100,i,e)),this.finalize(r,s)};x.finalize=function(t,i){if(t.then){const s=this;return t.then(function(n){return s.finalize(n,i)})}i&&t.length&&this.query&&(t=vt(this.query,t,this.index.index,this.field,i));const e=this.return;return this.highlight=this.index=this.result=this.C=this.await=this.return=null,this.query=this.field="",e&&e(t),t};function kt(t,i,e,s,n,r,o){const h=t.length;let l=[],f,u;f=A();for(let a=0,p,c,m,d;a<i;a++)for(let g=0;g<h;g++)if(m=t[g],a<m.length&&(p=m[a]))for(let y=0;y<p.length;y++){if(c=p[y],(u=f[c])?f[c]++:(u=0,f[c]=1),d=l[u]||(l[u]=[]),!o){let w=a+(g||!n?0:r||0);d=d[w]||(d[w]=[])}if(d.push(c),o&&e&&u===h-1&&d.length-s===e)return s?d.slice(s):d}if(t=l.length)if(n)l=l.length>1?ue(l,e,s,o,r):(l=l[0])&&e&&l.length>e||s?l.slice(s,e+s):l;else{if(t<h)return[];if(l=l[t-1],e||s)if(o)(l.length>e||s)&&(l=l.slice(s,e+s));else{n=[];for(let a=0,p;a<l.length;a++)if(p=l[a]){if(s&&p.length>s)s-=p.length;else if((e&&p.length>e||s)&&(p=p.slice(s,e+s),e-=p.length,s&&(s-=p.length)),n.push(p),!e)break}l=n}}return l}function ue(t,i,e,s,n){const r=[],o=A();let h;var l=t.length;let f;if(s){for(n=l-1;n>=0;n--)if(f=(s=t[n])&&s.length){for(l=0;l<f;l++)if(h=s[l],!o[h]){if(o[h]=1,e)e--;else if(r.push(h),r.length===i)return r}}}else for(let u=l-1,a,p=0;u>=0;u--){a=t[u];for(let c=0;c<a.length;c++)if(f=(s=a[c])&&s.length){for(let m=0;m<f;m++)if(h=s[m],!o[h])if(o[h]=1,e)e--;else{let d=(c+(u<l-1&&n||0))/(u+1)|0;if((r[d]||(r[d]=[])).push(h),++p===i)return r}}}return r}function De(t,i,e,s,n){const r=A(),o=[];for(let h=0,l;h<i.length;h++){l=i[h];for(let f=0;f<l.length;f++)r[l[f]]=1}if(n){for(let h=0,l;h<t.length;h++)if(l=t[h],r[l]){if(s)s--;else if(o.push(l),r[l]=0,e&&--e===0)break}}else for(let h=0,l,f;h<t.result.length;h++)for(l=t.result[h],i=0;i<l.length;i++)f=l[i],r[f]&&((o[h]||(o[h]=[])).push(f),r[f]=0);return o}q.prototype.search=function(t,i,e,s){e||(!i&&ut(t)?(e=t,t=""):ut(i)&&(e=i,i=0));let n=[];var r=[];let o,h,l,f,u,a,p=0,c=!0,m;if(e){e.constructor===Array&&(e={index:e}),t=e.query||t,o=e.pluck,h=e.merge,f=e.boost,a=o||e.field||(a=e.index)&&(a.index?null:a);var d=this.tag&&e.tag;l=e.suggest,c=e.resolve!==!1,u=e.cache,m=c&&this.store&&e.highlight;var g=!!m||c&&this.store&&e.enrich;i=e.limit||i;var y=e.offset||0;if(i||(i=c?100:0),d&&(!this.db||!s)){d.constructor!==Array&&(d=[d]);var w=[];for(let C=0,k;C<d.length;C++)if(k=d[C],k.field&&k.tag){var v=k.tag;if(v.constructor===Array)for(var N=0;N<v.length;N++)w.push(k.field,v[N]);else w.push(k.field,v)}else{v=Object.keys(k);for(let S=0,B,$;S<v.length;S++)if(B=v[S],$=k[B],$.constructor===Array)for(N=0;N<$.length;N++)w.push(B,$[N]);else w.push(B,$)}if(d=w,!t){if(r=[],w.length)for(d=0;d<w.length;d+=2){if(this.db){if(s=this.index.get(w[d]),!s)continue;r.push(s=s.db.tag(w[d+1],i,y,g))}else s=Je.call(this,w[d],w[d+1],i,y,g);n.push(c?{field:w[d],tag:w[d+1],result:s}:[s])}if(r.length){const C=this;return Promise.all(r).then(function(k){for(let S=0;S<k.length;S++)c?n[S].result=k[S]:n[S]=k[S];return c?n:new z(n.length>1?kt(n,1,0,0,l,f):n[0],C)})}return c?n:new z(n.length>1?kt(n,1,0,0,l,f):n[0],this)}}c||o||!(a=a||this.field)||(K(a)?o=a:(a.constructor===Array&&a.length===1&&(a=a[0]),o=a.field||a.index)),a&&a.constructor!==Array&&(a=[a])}a||(a=this.field);let _;w=(this.worker||this.db)&&!s&&[];for(let C=0,k,S,B;C<a.length;C++){if(S=a[C],this.db&&this.tag&&!this.B[C])continue;let $;if(K(S)||($=S,S=$.field,t=$.query||t,i=et($.limit,i),y=et($.offset,y),l=et($.suggest,l),m=c&&this.store&&et($.highlight,m),g=!!m||c&&this.store&&et($.enrich,g),u=et($.cache,u)),s)k=s[C];else{v=$||e||{},N=v.enrich;var M=this.index.get(S);if(d&&(this.db&&(v.tag=d,v.field=a,_=M.db.support_tag_search),!_&&N&&(v.enrich=!1),_||(v.limit=0,v.offset=0)),k=u?M.searchCache(t,d&&!_?0:i,v):M.search(t,d&&!_?0:i,v),d&&!_&&(v.limit=i,v.offset=y),N&&(v.enrich=N),w){w[C]=k;continue}}if(B=(k=k.result||k)&&k.length,d&&B){if(v=[],N=0,this.db&&s){if(!_)for(M=a.length;M<s.length;M++){let P=s[M];if(P&&P.length)N++,v.push(P);else if(!l)return c?n:new z(n,this)}}else for(let P=0,E,R;P<d.length;P+=2){if(E=this.tag.get(d[P]),!E){if(l)continue;return c?n:new z(n,this)}if(R=(E=E&&E.get(d[P+1]))&&E.length)N++,v.push(E);else if(!l)return c?n:new z(n,this)}if(N){if(k=De(k,v,i,y,c),B=k.length,!B&&!l)return c?k:new z(k,this);N--}}if(B)r[p]=S,n.push(k),p++;else if(a.length===1)return c?n:new z(n,this)}if(w){if(this.db&&d&&d.length&&!_)for(g=0;g<d.length;g+=2){if(r=this.index.get(d[g]),!r){if(l)continue;return c?n:new z(n,this)}w.push(r.db.tag(d[g+1],i,y,!1))}const C=this;return Promise.all(w).then(function(k){return e&&(e.resolve=c),k.length&&(k=C.search(t,i,e,k)),k})}if(!p)return c?n:new z(n,this);if(o&&(!g||!this.store))return n=n[0],c?n:new z(n,this);for(w=[],y=0;y<r.length;y++){if(d=n[y],g&&d.length&&typeof d[0].doc>"u"&&(this.db?w.push(d=this.index.get(this.field[0]).db.enrich(d)):d=st.call(this,d)),o)return c?m?vt(t,d,this.index,o,m):d:new z(d,this);n[y]={field:r[y],result:d}}if(g&&this.db&&w.length){const C=this;return Promise.all(w).then(function(k){for(let S=0;S<k.length;S++)n[S].result=k[S];return m&&(n=vt(t,n,C.index,o,m)),h?ee(n):n})}return m&&(n=vt(t,n,this.index,o,m)),h?ee(n):n};function ee(t){const i=[],e=A(),s=A();for(let n=0,r,o,h,l,f,u,a;n<t.length;n++){r=t[n],o=r.field,h=r.result;for(let p=0;p<h.length;p++)f=h[p],typeof f!="object"?f={id:l=f}:l=f.id,(u=e[l])?u.push(o):(f.field=e[l]=[o],i.push(f)),(a=f.highlight)&&(u=s[l],u||(s[l]=u={},f.highlight=u),u[o]=a)}return i}function Je(t,i,e,s,n){return t=this.tag.get(t),t?(t=t.get(i),t?(i=t.length-s,i>0&&((e&&i>e||s)&&(t=t.slice(s,s+e)),n&&(t=st.call(this,t))),t):[]):[]}function st(t){if(!this||!this.store)return t;if(this.db)return this.index.get(this.field[0]).db.enrich(t);const i=Array(t.length);for(let e=0,s;e<t.length;e++)s=t[e],i[e]={id:s,doc:this.store.get(s)};return i}function q(t){if(!this||this.constructor!==q)return new q(t);const i=t.document||t.doc||t;let e,s;if(this.B=[],this.field=[],this.D=[],this.key=(e=i.key||i.id)&&bt(e,this.D)||"id",(s=t.keystore||0)&&(this.keystore=s),this.fastupdate=!!t.fastupdate,this.reg=!this.fastupdate||t.worker||t.db?s?new W(s):new Set:s?new H(s):new Map,this.h=(e=i.store||null)&&e&&e!==!0&&[],this.store=e?s?new H(s):new Map:null,this.cache=(e=t.cache||null)&&new tt(e),t.cache=!1,this.worker=t.worker||!1,this.priority=t.priority||4,this.index=Fe.call(this,t,i),this.tag=null,(e=i.tag)&&(typeof e=="string"&&(e=[e]),e.length)){this.tag=new Map,this.A=[],this.F=[];for(let n=0,r,o;n<e.length;n++){if(r=e[n],o=r.field||r,!o)throw Error("The tag field from the document descriptor is undefined.");r.custom?this.A[n]=r.custom:(this.A[n]=bt(o,this.D),r.filter&&(typeof this.A[n]=="string"&&(this.A[n]=new String(this.A[n])),this.A[n].G=r.filter)),this.F[n]=o,this.tag.set(o,new Map)}}if(this.worker){this.fastupdate=!1,t=[];for(const n of this.index.values())n.then&&t.push(n);if(t.length){const n=this;return Promise.all(t).then(function(r){let o=0;for(const h of n.index.entries()){const l=h[0];let f=h[1];f.then&&(f=r[o],n.index.set(l,f),o++)}return n})}}else t.db&&(this.fastupdate=!1,this.mount(t.db))}x=q.prototype;x.mount=function(t){let i=this.field;if(this.tag)for(let r=0,o;r<this.F.length;r++){o=this.F[r];var e=void 0;this.index.set(o,e=new J({},this.reg)),i===this.field&&(i=i.slice(0)),i.push(o),e.tag=this.tag.get(o)}e=[];const s={db:t.db,type:t.type,fastupdate:t.fastupdate};for(let r=0,o,h;r<i.length;r++){s.field=h=i[r],o=this.index.get(h);const l=new t.constructor(t.id,s);l.id=t.id,e[r]=l.mount(o),o.document=!0,r?o.bypass=!0:o.store=this.store}const n=this;return this.db=Promise.all(e).then(function(){n.db=!0})};x.commit=async function(){const t=[];for(const i of this.index.values())t.push(i.commit());await Promise.all(t),this.reg.clear()};x.destroy=function(){const t=[];for(const i of this.index.values())t.push(i.destroy());return Promise.all(t)};function Fe(t,i){const e=new Map;let s=i.index||i.field||i;K(s)&&(s=[s]);for(let r=0,o,h;r<s.length;r++){if(o=s[r],K(o)||(h=o,o=o.field),h=ut(h)?Object.assign({},t,h):t,this.worker){var n=void 0;n=(n=h.encoder)&&n.encode?n:new at(typeof n=="string"?he[n]:n||{}),n=new ot(h,n),e.set(o,n)}this.worker||e.set(o,new J(h,this.reg)),h.custom?this.B[r]=h.custom:(this.B[r]=bt(o,this.D),h.filter&&(typeof this.B[r]=="string"&&(this.B[r]=new String(this.B[r])),this.B[r].G=h.filter)),this.field[r]=o}if(this.h){t=i.store,K(t)&&(t=[t]);for(let r=0,o,h;r<t.length;r++)o=t[r],h=o.field||o,o.custom?(this.h[r]=o.custom,o.custom.O=h):(this.h[r]=bt(h,this.D),o.filter&&(typeof this.h[r]=="string"&&(this.h[r]=new String(this.h[r])),this.h[r].G=o.filter))}return e}function bt(t,i){const e=t.split(":");let s=0;for(let n=0;n<e.length;n++)t=e[n],t[t.length-1]==="]"&&(t=t.substring(0,t.length-2))&&(i[s]=!0),t&&(e[s++]=t);return s<e.length&&(e.length=s),s>1?e:e[0]}x.append=function(t,i){return this.add(t,i,!0)};x.update=function(t,i){return this.remove(t).add(t,i)};x.remove=function(t){ut(t)&&(t=ct(t,this.key));for(var i of this.index.values())i.remove(t,!0);if(this.reg.has(t)){if(this.tag&&!this.fastupdate)for(let e of this.tag.values())for(let s of e){i=s[0];const n=s[1],r=n.indexOf(t);r>-1&&(n.length>1?n.splice(r,1):e.delete(i))}this.store&&this.store.delete(t),this.reg.delete(t)}return this.cache&&this.cache.remove(t),this};x.clear=function(){const t=[];for(const i of this.index.values()){const e=i.clear();e.then&&t.push(e)}if(this.tag)for(const i of this.tag.values())i.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),t.length?Promise.all(t):this};x.contain=function(t){return this.db?this.index.get(this.field[0]).db.has(t):this.reg.has(t)};x.cleanup=function(){for(const t of this.index.values())t.cleanup();return this};x.get=function(t){return this.db?this.index.get(this.field[0]).db.enrich(t).then(function(i){return i[0]&&i[0].doc||null}):this.store.get(t)||null};x.set=function(t,i){return typeof t=="object"&&(i=t,t=ct(i,this.key)),this.store.set(t,i),this};x.searchCache=Rt;x.export=Ve;x.import=Qe;Kt(q.prototype);function Dt(t,i=0){let e=[],s=[];i&&(i=25e4/i*5e3|0);for(const n of t.entries())s.push(n),s.length===i&&(e.push(s),s=[]);return s.length&&e.push(s),e}function Jt(t,i){i||(i=new Map);for(let e=0,s;e<t.length;e++)s=t[e],i.set(s[0],s[1]);return i}function ce(t,i=0){let e=[],s=[];i&&(i=25e4/i*1e3|0);for(const n of t.entries())s.push([n[0],Dt(n[1])[0]||[]]),s.length===i&&(e.push(s),s=[]);return s.length&&e.push(s),e}function ae(t,i){i||(i=new Map);for(let e=0,s,n;e<t.length;e++)s=t[e],n=i.get(s[0]),i.set(s[0],Jt(s[1],n));return i}function de(t){let i=[],e=[];for(const s of t.keys())e.push(s),e.length===25e4&&(i.push(e),e=[]);return e.length&&i.push(e),i}function pe(t,i){i||(i=new Set);for(let e=0;e<t.length;e++)i.add(t[e]);return i}function jt(t,i,e,s,n,r,o=0){const h=s&&s.constructor===Array;var l=h?s.shift():s;if(!l)return this.export(t,i,n,r+1);if((l=t((i?i+".":"")+(o+1)+"."+e,JSON.stringify(l)))&&l.then){const f=this;return l.then(function(){return jt.call(f,t,i,e,h?s:null,n,r,o+1)})}return jt.call(this,t,i,e,h?s:null,n,r,o+1)}function Ve(t,i,e=0,s=0){if(e<this.field.length){const o=this.field[e];if((i=this.index.get(o).export(t,o,e,s=1))&&i.then){const h=this;return i.then(function(){return h.export(t,o,e+1)})}return this.export(t,o,e+1)}let n,r;switch(s){case 0:n="reg",r=de(this.reg),i=null;break;case 1:n="tag",r=this.tag&&ce(this.tag,this.reg.size),i=null;break;case 2:n="doc",r=this.store&&Dt(this.store),i=null;break;default:return}return jt.call(this,t,i,n,r||null,e,s)}function Qe(t,i){var e=t.split(".");e[e.length-1]==="json"&&e.pop();const s=e.length>2?e[0]:"";if(e=e.length>2?e[2]:e[1],this.worker&&s)return this.index.get(s).import(t);if(i){if(typeof i=="string"&&(i=JSON.parse(i)),s)return this.index.get(s).import(e,i);switch(e){case"reg":this.fastupdate=!1,this.reg=pe(i,this.reg);for(let n=0,r;n<this.field.length;n++)r=this.index.get(this.field[n]),r.fastupdate=!1,r.reg=this.reg;if(this.worker){i=[];for(const n of this.index.values())i.push(n.import(t));return Promise.all(i)}break;case"tag":this.tag=ae(i,this.tag);break;case"doc":this.store=Jt(i,this.store)}}}function ie(t,i){let e="";for(const s of t.entries()){t=s[0];const n=s[1];let r="";for(let o=0,h;o<n.length;o++){h=n[o]||[""];let l="";for(let f=0;f<h.length;f++)l+=(l?",":"")+(i==="string"?'"'+h[f]+'"':h[f]);l="["+l+"]",r+=(r?",":"")+l}r='["'+t+'",['+r+"]]",e+=(e?",":"")+r}return e}J.prototype.remove=function(t,i){const e=this.reg.size&&(this.fastupdate?this.reg.get(t):this.reg.has(t));if(e){if(this.fastupdate){for(let s=0,n,r;s<e.length;s++)if((n=e[s])&&(r=n.length))if(n[r-1]===t)n.pop();else{const o=n.indexOf(t);o>=0&&n.splice(o,1)}}else dt(this.map,t),this.depth&&dt(this.ctx,t);i||this.reg.delete(t)}return this.db&&(this.commit_task.push({del:t}),this.M&&ge(this)),this.cache&&this.cache.remove(t),this};function dt(t,i){let e=0;var s=typeof i>"u";if(t.constructor===Array){for(let n=0,r,o,h;n<t.length;n++)if((r=t[n])&&r.length){if(s)return 1;if(o=r.indexOf(i),o>=0){if(r.length>1)return r.splice(o,1),1;if(delete t[n],e)return 1;h=1}else{if(h)return 1;e++}}}else for(let n of t.entries())s=n[0],dt(n[1],i)?e++:t.delete(s);return e}const Xe={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};J.prototype.add=function(t,i,e,s){if(i&&(t||t===0)){if(!s&&!e&&this.reg.has(t))return this.update(t,i);s=this.depth,i=this.encoder.encode(i,!s);const f=i.length;if(f){const u=A(),a=A(),p=this.resolution;for(let c=0;c<f;c++){let m=i[this.rtl?f-1-c:c];var n=m.length;if(n&&(s||!a[m])){var r=this.score?this.score(i,m,c,null,0):xt(p,f,c),o="";switch(this.tokenize){case"tolerant":if(F(this,a,m,r,t,e),n>2){for(let d=1,g,y,w,v;d<n-1;d++)g=m.charAt(d),y=m.charAt(d+1),w=m.substring(0,d)+y,v=m.substring(d+2),o=w+g+v,F(this,a,o,r,t,e),o=w+v,F(this,a,o,r,t,e);F(this,a,m.substring(0,m.length-1),r,t,e)}break;case"full":if(n>2){for(let d=0,g;d<n;d++)for(r=n;r>d;r--){o=m.substring(d,r),g=this.rtl?n-1-d:d;var h=this.score?this.score(i,m,c,o,g):xt(p,f,c,n,g);F(this,a,o,h,t,e)}break}case"bidirectional":case"reverse":if(n>1){for(h=n-1;h>0;h--){o=m[this.rtl?n-1-h:h]+o;var l=this.score?this.score(i,m,c,o,h):xt(p,f,c,n,h);F(this,a,o,l,t,e)}o=""}case"forward":if(n>1){for(h=0;h<n;h++)o+=m[this.rtl?n-1-h:h],F(this,a,o,r,t,e);break}default:if(F(this,a,m,r,t,e),s&&f>1&&c<f-1)for(n=this.N,o=m,r=Math.min(s+1,this.rtl?c+1:f-c),h=1;h<r;h++){m=i[this.rtl?f-1-c-h:c+h],l=this.bidirectional&&m>o;const d=this.score?this.score(i,o,c,m,h-1):xt(n+(f/2>n?0:1),f,c,r-1,h-1);F(this,u,l?o:m,d,t,e,l?m:o)}}}}this.fastupdate||this.reg.add(t)}}return this.db&&(this.commit_task.push(e?{ins:t}:{del:t}),this.M&&ge(this)),this};function F(t,i,e,s,n,r,o){let h,l;if(!(h=i[e])||o&&!h[o]){if(o?(i=h||(i[e]=A()),i[o]=1,l=t.ctx,(h=l.get(o))?l=h:l.set(o,l=t.keystore?new H(t.keystore):new Map)):(l=t.map,i[e]=1),(h=l.get(e))?l=h:l.set(e,l=h=[]),r){for(let f=0,u;f<h.length;f++)if((u=h[f])&&u.includes(n)){if(f<=s)return;u.splice(u.indexOf(n),1),t.fastupdate&&(i=t.reg.get(n))&&i.splice(i.indexOf(u),1);break}}if(l=l[s]||(l[s]=[]),l.push(n),l.length===2**31-1){if(i=new rt(l),t.fastupdate)for(let f of t.reg.values())f.includes(l)&&(f[f.indexOf(l)]=i);h[s]=l=i}t.fastupdate&&((s=t.reg.get(n))?s.push(l):t.reg.set(n,[l]))}}function xt(t,i,e,s,n){return e&&t>1?i+(s||0)<=t?e+(n||0):(t-1)/(i+(s||0))*(e+(n||0))+1|0:0}J.prototype.search=function(t,i,e){if(e||(i||typeof t!="object"?typeof i=="object"&&(e=i,i=0):(e=t,t="")),e&&e.cache)return e.cache=!1,t=this.searchCache(t,i,e),e.cache=!0,t;let s=[],n,r,o,h=0,l,f,u,a,p;e&&(t=e.query||t,i=e.limit||i,h=e.offset||0,r=e.context,o=e.suggest,p=(l=e.resolve)&&e.enrich,u=e.boost,a=e.resolution,f=this.db&&e.tag),typeof l>"u"&&(l=this.resolve),r=this.depth&&r!==!1;let c=this.encoder.encode(t,!r);if(n=c.length,i=i||(l?100:0),n===1)return se.call(this,c[0],"",i,h,l,p,f);if(n===2&&r&&!o)return se.call(this,c[1],c[0],i,h,l,p,f);let m=A(),d=0,g;if(r&&(g=c[0],d=1),a||a===0||(a=g?this.N:this.resolution),this.db){if(this.db.search&&(e=this.db.search(this,c,i,h,o,l,p,f),e!==!1))return e;const y=this;return(async function(){for(let w,v;d<n;d++){if((v=c[d])&&!m[v]){if(m[v]=1,w=await Pt(y,v,g,0,0,!1,!1),w=re(w,s,o,a)){s=w;break}g&&(o&&w&&s.length||(g=v))}o&&g&&d===n-1&&!s.length&&(a=y.resolution,g="",d=-1,m=A())}return ne(s,a,i,h,o,u,l)})()}for(let y,w;d<n;d++){if((w=c[d])&&!m[w]){if(m[w]=1,y=Pt(this,w,g,0,0,!1,!1),y=re(y,s,o,a)){s=y;break}g&&(o&&y&&s.length||(g=w))}o&&g&&d===n-1&&!s.length&&(a=this.resolution,g="",d=-1,m=A())}return ne(s,a,i,h,o,u,l)};function ne(t,i,e,s,n,r,o){let h=t.length,l=t;if(h>1)l=kt(t,i,e,s,n,r,o);else if(h===1)return o?Ht.call(null,t[0],e,s):new z(t[0],this);return o?l:new z(l,this)}function se(t,i,e,s,n,r,o){return t=Pt(this,t,i,e,s,n,r,o),this.db?t.then(function(h){return n?h||[]:new z(h,this)}):t&&t.length?n?Ht.call(this,t,e,s):new z(t,this):n?[]:new z([],this)}function re(t,i,e,s){let n=[];if(t&&t.length){if(t.length<=s){i.push(t);return}for(let r=0,o;r<s;r++)(o=t[r])&&(n[r]=o);if(n.length){i.push(n);return}}if(!e)return n}function Pt(t,i,e,s,n,r,o,h){let l;return e&&(l=t.bidirectional&&i>e)&&(l=e,e=i,i=l),t.db?t.db.get(i,e,s,n,r,o,h):(t=e?(t=t.ctx.get(e))&&t.get(i):t.map.get(i),t)}function J(t,i){if(!this||this.constructor!==J)return new J(t);if(t){var e=K(t)?t:t.preset;e&&(t=Object.assign({},Xe[e],t))}else t={};e=t.context;const s=e===!0?{depth:1}:e||{},n=K(t.encoder)?he[t.encoder]:t.encode||t.encoder||{};this.encoder=n.encode?n:typeof n=="object"?new at(n):{encode:n},this.resolution=t.resolution||9,this.tokenize=e=(e=t.tokenize)&&e!=="default"&&e!=="exact"&&e||"strict",this.depth=e==="strict"&&s.depth||0,this.bidirectional=s.bidirectional!==!1,this.fastupdate=!!t.fastupdate,this.score=t.score||null,(e=t.keystore||0)&&(this.keystore=e),this.map=e?new H(e):new Map,this.ctx=e?new H(e):new Map,this.reg=i||(this.fastupdate?e?new H(e):new Map:e?new W(e):new Set),this.N=s.resolution||3,this.rtl=n.rtl||t.rtl||!1,this.cache=(e=t.cache||null)&&new tt(e),this.resolve=t.resolve!==!1,(e=t.db)&&(this.db=this.mount(e)),this.M=t.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=t.priority||4}x=J.prototype;x.mount=function(t){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),t.mount(this)};x.commit=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this)};x.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function ge(t){t.commit_timer||(t.commit_timer=setTimeout(function(){t.commit_timer=null,t.db.commit(t)},1))}x.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db?(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[],this.db.clear()):this};x.append=function(t,i){return this.add(t,i,!0)};x.contain=function(t){return this.db?this.db.has(t):this.reg.has(t)};x.update=function(t,i){const e=this,s=this.remove(t);return s&&s.then?s.then(()=>e.add(t,i)):this.add(t,i)};x.cleanup=function(){return this.fastupdate?(dt(this.map),this.depth&&dt(this.ctx),this):this};x.searchCache=Rt;x.export=function(t,i,e=0,s=0){let n,r;switch(s){case 0:n="reg",r=de(this.reg);break;case 1:n="cfg",r=null;break;case 2:n="map",r=Dt(this.map,this.reg.size);break;case 3:n="ctx",r=ce(this.ctx,this.reg.size);break;default:return}return jt.call(this,t,i,n,r,e,s)};x.import=function(t,i){if(i)switch(typeof i=="string"&&(i=JSON.parse(i)),t=t.split("."),t[t.length-1]==="json"&&t.pop(),t.length===3&&t.shift(),t=t.length>1?t[1]:t[0],t){case"reg":this.fastupdate=!1,this.reg=pe(i,this.reg);break;case"map":this.map=Jt(i,this.map);break;case"ctx":this.ctx=ae(i,this.ctx)}};x.serialize=function(t=!0){let i="",e="",s="";if(this.reg.size){let r;for(var n of this.reg.keys())r||(r=typeof n),i+=(i?",":"")+(r==="string"?'"'+n+'"':n);i="index.reg=new Set(["+i+"]);",e=ie(this.map,r),e="index.map=new Map(["+e+"]);";for(const o of this.ctx.entries()){n=o[0];let h=ie(o[1],r);h="new Map(["+h+"])",h='["'+n+'",'+h+"]",s+=(s?",":"")+h}s="index.ctx=new Map(["+s+"]);"}return t?"function inject(index){"+i+e+s+"}":i+e+s};Kt(J.prototype);const me=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Ct=["map","ctx","tag","reg","cfg"],U=A();function It(t,i={}){if(!this||this.constructor!==It)return new It(t,i);typeof t=="object"&&(i=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=i.field?i.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=i.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}x=It.prototype;x.mount=function(t){return t.index?t.mount(this):(t.db=this,this.open())};x.open=function(){if(this.db)return this.db;let t=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist(),U[t.id]||(U[t.id]=[]),U[t.id].push(t.field);const i=me.open(t.id,1);return i.onupgradeneeded=function(){const e=t.db=this.result;for(let s=0,n;s<Ct.length;s++){n=Ct[s];for(let r=0,o;r<U[t.id].length;r++)o=U[t.id][r],e.objectStoreNames.contains(n+(n!=="reg"&&o?":"+o:""))||e.createObjectStore(n+(n!=="reg"&&o?":"+o:""))}},t.db=Z(i,function(e){t.db=e,t.db.onversionchange=function(){t.close()}})};x.close=function(){this.db&&this.db.close(),this.db=null};x.destroy=function(){const t=me.deleteDatabase(this.id);return Z(t)};x.clear=function(){const t=[];for(let e=0,s;e<Ct.length;e++){s=Ct[e];for(let n=0,r;n<U[this.id].length;n++)r=U[this.id][n],t.push(s+(s!=="reg"&&r?":"+r:""))}const i=this.db.transaction(t,"readwrite");for(let e=0;e<t.length;e++)i.objectStore(t[e]).clear();return Z(i)};x.get=function(t,i,e=0,s=0,n=!0,r=!1){t=this.db.transaction((i?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((i?"ctx":"map")+(this.field?":"+this.field:"")).get(i?i+":"+t:t);const o=this;return Z(t).then(function(h){let l=[];if(!h||!h.length)return l;if(n){if(!e&&!s&&h.length===1)return h[0];for(let f=0,u;f<h.length;f++)if((u=h[f])&&u.length){if(s>=u.length){s-=u.length;continue}const a=e?s+Math.min(u.length-s,e):u.length;for(let p=s;p<a;p++)l.push(u[p]);if(s=0,l.length===e)break}return r?o.enrich(l):l}return h})};x.tag=function(t,i=0,e=0,s=!1){t=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(t);const n=this;return Z(t).then(function(r){return!r||!r.length||e>=r.length?[]:!i&&!e?r:(r=r.slice(e,e+i),s?n.enrich(r):r)})};x.enrich=function(t){typeof t!="object"&&(t=[t]);const i=this.db.transaction("reg","readonly").objectStore("reg"),e=[];for(let s=0;s<t.length;s++)e[s]=Z(i.get(t[s]));return Promise.all(e).then(function(s){for(let n=0;n<s.length;n++)s[n]={id:t[n],doc:s[n]?JSON.parse(s[n]):null};return s})};x.has=function(t){return t=this.db.transaction("reg","readonly").objectStore("reg").getKey(t),Z(t).then(function(i){return!!i})};x.search=null;x.info=function(){};x.transaction=function(t,i,e){t+=t!=="reg"&&this.field?":"+this.field:"";let s=this.h[t+":"+i];if(s)return e.call(this,s);let n=this.db.transaction(t,i);this.h[t+":"+i]=s=n.objectStore(t);const r=e.call(this,s);return this.h[t+":"+i]=null,Z(n).finally(function(){return r})};x.commit=async function(t){let i=t.commit_task,e=[];t.commit_task=[];for(let s=0,n;s<i.length;s++)n=i[s],n.del&&e.push(n.del);e.length&&await this.remove(e),t.reg.size&&(await this.transaction("map","readwrite",function(s){for(const n of t.map){const r=n[0],o=n[1];o.length&&(s.get(r).onsuccess=function(){let h=this.result;var l;if(h&&h.length){const f=Math.max(h.length,o.length);for(let u=0,a,p;u<f;u++)if((p=o[u])&&p.length){if((a=h[u])&&a.length)for(l=0;l<p.length;l++)a.push(p[l]);else h[u]=p;l=1}}else h=o,l=1;l&&s.put(h,r)})}}),await this.transaction("ctx","readwrite",function(s){for(const n of t.ctx){const r=n[0],o=n[1];for(const h of o){const l=h[0],f=h[1];f.length&&(s.get(r+":"+l).onsuccess=function(){let u=this.result;var a;if(u&&u.length){const p=Math.max(u.length,f.length);for(let c=0,m,d;c<p;c++)if((d=f[c])&&d.length){if((m=u[c])&&m.length)for(a=0;a<d.length;a++)m.push(d[a]);else u[c]=d;a=1}}else u=f,a=1;a&&s.put(u,r+":"+l)})}}}),t.store?await this.transaction("reg","readwrite",function(s){for(const n of t.store){const r=n[0],o=n[1];s.put(typeof o=="object"?JSON.stringify(o):1,r)}}):t.bypass||await this.transaction("reg","readwrite",function(s){for(const n of t.reg.keys())s.put(1,n)}),t.tag&&await this.transaction("tag","readwrite",function(s){for(const n of t.tag){const r=n[0],o=n[1];o.length&&(s.get(r).onsuccess=function(){let h=this.result;h=h&&h.length?h.concat(o):o,s.put(h,r)})}}),t.map.clear(),t.ctx.clear(),t.tag&&t.tag.clear(),t.store&&t.store.clear(),t.document||t.reg.clear())};function zt(t,i,e){const s=t.value;let n,r=0;for(let o=0,h;o<s.length;o++){if(h=e?s:s[o]){for(let l=0,f,u;l<i.length;l++)if(u=i[l],f=h.indexOf(u),f>=0)if(n=1,h.length>1)h.splice(f,1);else{s[o]=[];break}r+=h.length}if(e)break}r?n&&t.update(s):t.delete(),t.continue()}x.remove=function(t){return typeof t!="object"&&(t=[t]),Promise.all([this.transaction("map","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&zt(e,t)}}),this.transaction("ctx","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&zt(e,t)}}),this.transaction("tag","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&zt(e,t,!0)}}),this.transaction("reg","readwrite",function(i){for(let e=0;e<t.length;e++)i.delete(t[e])})])};function Z(t,i){return new Promise((e,s)=>{t.onsuccess=t.oncomplete=function(){i&&i(this.result),i=null,e(this.result)},t.onerror=t.onblocked=s,t=null})}const Ze=q;function ti({onSchemaSelect:t}){const[i,e]=T.useState(!1),[s,n]=T.useState(""),[r,o]=T.useState([]),[h,l]=T.useState(null),[f,u]=T.useState([]);T.useEffect(()=>{(async()=>{try{const c=Vt("/schemas"),y=((await(await fetch(`${c}data/schemas.json`)).json()).schemas||[]).map(v=>({...v,searchableContent:we(v.rawContent)}));o(y);const w=new Ze({document:{id:"id",index:["title","description","path","searchableContent"],store:["id","path","version","title","description","category","rawContent","searchableContent"]},tokenize:"forward",resolution:9});y.forEach(v=>{w.add(v)}),l(w)}catch(c){console.error("Failed to load schemas:",c)}})()},[]),T.useEffect(()=>{const p=c=>{(c.metaKey||c.ctrlKey)&&c.key==="k"&&(c.preventDefault(),e(!0))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[]),T.useEffect(()=>{(async()=>{if(!h||!s.trim()){u([]);return}const c=await h.searchAsync(s,{limit:20,enrich:!0}),m=new Map;c.forEach(d=>{const g=d.field;d.result.forEach(y=>{if(!m.has(y.id)){const w=y.doc,v=Ye(w,s,g);m.set(y.id,{id:w.id,path:w.path,version:w.version,title:w.title,description:w.description,category:w.category,rawContent:w.rawContent,matchPreview:v.preview,matchField:v.field})}})}),u(Array.from(m.values()))})()},[s,h]);const a=p=>{const c=Vt("/schemas"),m=`${p.path}/v${p.version}`;t&&window.location.pathname.includes("/graph")?(t(p.id),e(!1)):window.location.href=`${c}schema/${m}`};return j.jsxs(Me,{open:i,onOpenChange:e,children:[j.jsx(Ne,{asChild:!0,children:j.jsxs(ve,{variant:"outline",className:"justify-start text-sm text-muted-foreground min-w-[240px] max-w-[320px] h-10",children:[j.jsx(_t,{className:"mr-2 h-4 w-4 flex-shrink-0"}),j.jsx("span",{className:"truncate",children:"Search schemas..."}),j.jsxs("kbd",{className:"pointer-events-none ml-auto hidden h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex flex-shrink-0",children:[j.jsx("span",{className:"text-xs",children:"âŒ˜"}),"K"]})]})}),j.jsxs(_e,{className:"p-0 max-h-[80vh] flex flex-col",children:[j.jsxs("div",{className:"flex items-center border-b px-4 py-3",children:[j.jsx(_t,{className:"mr-2 h-5 w-5 text-muted-foreground flex-shrink-0"}),j.jsx("input",{type:"text",placeholder:"Search by title, description, path, or content...",value:s,onChange:p=>n(p.target.value),className:"flex-1 bg-transparent outline-none text-sm placeholder:text-muted-foreground",autoFocus:!0}),s&&j.jsx("button",{onClick:()=>n(""),className:"ml-2 text-muted-foreground hover:text-foreground text-xs px-2 py-1 rounded border",children:"Clear"})]}),j.jsx("div",{className:"overflow-y-auto flex-1 p-2",children:s?f.length===0?j.jsxs("div",{className:"p-8 text-center text-muted-foreground text-sm",children:[j.jsx("p",{className:"font-medium mb-1",children:"No results found"}),j.jsx("p",{className:"text-xs",children:"Try a different search term"})]}):j.jsx("div",{className:"space-y-1",children:f.map(p=>j.jsx("button",{onClick:()=>a(p),className:"w-full text-left px-3 py-3 rounded-md hover:bg-accent transition-colors group",children:j.jsxs("div",{className:"flex items-start justify-between gap-2",children:[j.jsxs("div",{className:"flex-1 min-w-0",children:[j.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[j.jsx("span",{className:"font-medium text-sm truncate",children:p.title}),j.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full capitalize flex-shrink-0",style:{backgroundColor:p.category==="common"?"#3b82f620":p.category==="infra"?"#10b98120":"#f59e0b20",color:p.category==="common"?"#3b82f6":p.category==="infra"?"#10b981":"#f59e0b"},children:p.category})]}),j.jsx("p",{className:"text-xs text-muted-foreground mb-1 line-clamp-2",children:p.description}),p.matchPreview&&j.jsxs("div",{className:"mb-1 text-xs bg-muted/50 rounded px-2 py-1 font-mono",children:[j.jsxs("span",{className:"text-muted-foreground/70 mr-1",children:[p.matchField,":"]}),j.jsx("span",{className:"text-foreground",dangerouslySetInnerHTML:{__html:p.matchPreview}})]}),j.jsxs("p",{className:"text-xs text-muted-foreground/70 font-mono",children:[p.path,"/v",p.version]})]}),j.jsx(be,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 mt-1"})]})},p.id))}):j.jsxs("div",{className:"p-8 text-center text-muted-foreground text-sm",children:[j.jsx(_t,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),j.jsx("p",{className:"font-medium mb-1",children:"Search for schemas"}),j.jsx("p",{className:"text-xs",children:"Try searching by title, description, hierarchy, or schema content"})]})}),j.jsxs("div",{className:"border-t px-4 py-2 text-xs text-muted-foreground flex items-center justify-between",children:[j.jsx("span",{children:s&&f.length>0&&`${f.length} result${f.length===1?"":"s"}`}),j.jsxs("div",{className:"flex items-center gap-2",children:[j.jsx("kbd",{className:"px-2 py-1 rounded border bg-muted",children:"Esc"}),j.jsx("span",{children:"Close"})]})]})]})]})}function we(t,i=0,e=5){if(i>e||!t||typeof t!="object")return"";const s=[];for(const n in t){const r=t[n];s.push(n),typeof r=="string"?s.push(r):typeof r=="object"&&r!==null&&s.push(we(r,i+1,e))}return s.filter(Boolean).join(" ")}function Ye(t,i,e){const s=i.toLowerCase(),n=100,r=40;if(e==="title"&&t.title.toLowerCase().includes(s))return{preview:Bt(t.title,i),field:"title"};if(e==="description"&&t.description.toLowerCase().includes(s))return{preview:oe(t.description,i,n,r),field:"description"};if(e==="path"&&t.path.toLowerCase().includes(s))return{preview:Bt(t.path,i),field:"path"};if(e==="searchableContent"&&t.searchableContent.toLowerCase().includes(s)){const o=xe(t.rawContent,i);if(o)return{preview:oe(o.value,i,n,r),field:o.path||"content"}}return{preview:Bt(t.title,i),field:e||"title"}}function Bt(t,i){const e=i.toLowerCase(),n=t.toLowerCase().indexOf(e);if(n===-1)return V(t);const r=t.slice(0,n),o=t.slice(n,n+i.length),h=t.slice(n+i.length);return`${V(r)}<mark class="bg-yellow-200 dark:bg-yellow-800 text-foreground px-0.5 rounded">${V(o)}</mark>${V(h)}`}function oe(t,i,e,s){const n=i.toLowerCase(),o=t.toLowerCase().indexOf(n);if(o===-1)return V(t.slice(0,e))+(t.length>e?"...":"");const h=Math.max(0,o-s),l=Math.min(t.length,o+i.length+s),f=t.slice(h,l),u=h>0?"...":"",a=l<t.length?"...":"",c=f.toLowerCase().indexOf(n);if(c===-1)return u+V(f)+a;const m=f.slice(0,c),d=f.slice(c,c+i.length),g=f.slice(c+i.length);return`${u}${V(m)}<mark class="bg-yellow-200 dark:bg-yellow-800 text-foreground px-0.5 rounded">${V(d)}</mark>${V(g)}${a}`}function xe(t,i,e="",s=0,n=10){if(s>n||!t||typeof t!="object")return null;const r=i.toLowerCase();for(const o in t){const h=t[o],l=e?`${e}.${o}`:o;if(o.toLowerCase().includes(r))return{value:`${o}: ${JSON.stringify(h)}`.slice(0,200),path:l};if(typeof h=="string"&&h.toLowerCase().includes(r))return{value:h,path:l};if(typeof h=="object"&&h!==null){const f=xe(h,i,l,s+1,n);if(f)return f}}return null}function V(t){const i=document.createElement("div");return i.textContent=t,i.innerHTML}export{ti as default};
